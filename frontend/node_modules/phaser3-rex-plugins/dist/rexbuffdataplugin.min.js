!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexbuffdataplugin=e();}(undefined,(function(){function t(t,n,s){return n=f(n),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}(t,e()?Reflect.construct(n,s||[],f(t).constructor):n.apply(t,s))}function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));}catch(t){}return (e=function(){return !!t})()}function n(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var s=n.call(t,e||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===e?String:Number)(t)}(t,"string");return "symbol"==typeof e?e:String(e)}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var s=0;s<e.length;s++){var r=e[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r);}}function u(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e);}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var c=function(){function t(){r(this,t),this.buffs={};}return u(t,[{key:"setEnable",value:function(t,e){return void 0===e&&(e=!0),this.buffs.hasOwnProperty(t)||(this.buffs[t]={enable:!0,value:0,type:l}),this.buffs[t].enable=e,this}},{key:"set",value:function(t,e){this.setEnable(t);var n=s(e);"number"===n?n=l:"string"===n&&(-1!==e.indexOf("%")?(n=b,e=parseFloat(e)/100):(n=l,e=parseFloat(e)));var r=this.buffs[t];return r.value=e,r.type=n,this}},{key:"remove",value:function(t){return this.buffs.hasOwnProperty(t)&&delete this.buffs[t],this}},{key:"buff",value:function(t){var e,n,s=t,r=this.buffs;for(var i in r)if((e=r[i]).enable)switch(n=e.type,e=e.value,n){case l:s+=e;break;case b:s+=t*e;}return s}}]),t}(),l=0,b=1,y=Phaser.Utils.Objects.IsPlainObject,p=Phaser.Utils.Objects.GetValue,d=function(){function t(e,n){if(r(this,t),y(e)){var s=e;e=p(s,"min",void 0),n=p(s,"max",void 0);}this.setMin(e),this.setMax(n);}return u(t,[{key:"setMin",value:function(t){return this.min=t,this}},{key:"setMax",value:function(t){return this.max=t,this}},{key:"clamp",value:function(t){return void 0!==this.min&&t<this.min?t=this.min:void 0!==this.max&&t>this.max&&(t=this.max),t}}]),t}(),v={setBaseValue:function(t,e){return this.baseValues[t]=e,this.set(t,this.getBuffResult(t)),this},removeBaseValue:function(t){return this.baseValues.hasOwnProperty(t)&&(delete this.baseValues[t],this.remove(t)),this},setBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new c),this.buffs[t].set(e,n),this.set(t,this.getBuffResult(t)),this},enableBuff:function(t,e,n){return this.buffs.hasOwnProperty(t)||(this.buffs[t]=new c),this.buffs[t].setEnable(e,n),this.set(t,this.getBuffResult(t)),this},removeBuff:function(t,e){return this.buffs.hasOwnProperty(t)&&(void 0===e?delete this.buffs[t]:this.buffs[t].remove(e)),this.set(t,this.getBuffResult(t)),this},setMin:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMin(e),this.set(t,this.getBuffResult(t)),this},setMax:function(t,e){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMax(e),this.set(t,this.getBuffResult(t)),this},setBounds:function(t,e,n){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t].setMin(e).setMax(n),this.set(t,this.getBuffResult(t)),this},getBuffResult:function(t){return this.clamp(t,this.buff(t))},buff:function(t,e){return void 0===e&&(e=this.getBaseValue(t)),this.buffs.hasOwnProperty(t)?this.buffs[t].buff(e):e},clamp:function(t,e){return void 0===e&&(e=this.list[t]),this.bounds.hasOwnProperty(t)?this.bounds[t].clamp(e):e},getBaseValue:function(t){return this.baseValues.hasOwnProperty(t)||(this.baseValues[t]=0),this.baseValues[t]},getBuffs:function(t,e){var n=this.buffs[t];return void 0===e?n:n&&n.hasOwnProperty(e)?n[e]:void 0},getBuffValue:function(t,e){return this.getBuffs(t,e).value},getBounds:function(t){return this.bounds.hasOwnProperty(t)||(this.bounds[t]=new d),this.bounds[t]},getMinBound:function(t){return this.getBounds(t).min},getMaxBound:function(t){return this.getBounds(t).max}},m=function(t){return void 0===t.buffs&&(t.baseValues={},t.buffs={},t.bounds={}),void 0===t.addBuff&&Object.assign(t,v),t},g=Phaser.Data.DataManager,w=Phaser.Events.EventEmitter,O=function(e){function n(e,s){var i;r(this,n);var u=void 0===s;if(u&&(s=new w),i=t(this,n,[e,s]),u){var o=e.events?e.events:e;o&&o.once("destroy",i.destroy,h(i));}return m(h(i)),i}return o(n,e),u(n)}(g);return Object.assign(O.prototype,v),function(e){function n(e){return r(this,n),t(this,n,[e])}return o(n,Phaser.Plugins.BasePlugin),u(n,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this);}},{key:"add",value:function(t,e){return new O(t,e)}},{key:"extend",value:function(t){return m(t)}}]),n}()}));
