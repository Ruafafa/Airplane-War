!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rexsequenceplugin=e();}(undefined,(function(){function t(t,i,n){return i=o(i),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,e()?Reflect.construct(i,n||[],o(t).constructor):i.apply(t,n))}function e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));}catch(t){}return (e=function(){return !!t})()}function i(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return ("string"===e?String:Number)(t)}(t,"string");return "symbol"==typeof e?e:String(e)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r);}}function s(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},o(t)}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}var h={setEventEmitter:function(t,e){return void 0===e&&(e=Phaser.Events.EventEmitter),this._privateEE=!0===t||void 0===t,this._eventEmitter=this._privateEE?new e:t,this},destroyEventEmitter:function(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(t){return this._eventEmitter&&t&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames:function(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},a=function(t,e,i){if(!t||"number"==typeof t)return i;if("string"==typeof e){if(t.hasOwnProperty(e))return t[e];if(-1===e.indexOf("."))return i;e=e.split(".");}for(var n=e,r=t,s=i,o=0;o<n.length;o++){if(e=n[o],!r.hasOwnProperty(e)){s=i;break}r=s=r[e];}return s},f=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=e.length),t.length=n-i;for(var r=0,s=t.length;r<s;r++)t[r]=e[r+i];return t},c=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,p=/^0x[0-9A-F]+$/i,l=function(t){if("string"!=typeof t)return t;if(""===t)t=null;else if(c.test(t))t=parseFloat(t);else if(p.test(t))t=parseInt(t,16);else switch(t){case"false":t=!1;break;case"true":t=!0;break;case"null":t=null;break;case"undefined":t=void 0;}return t},v=function t(e,i,n){var r,s,o=a(n,"reverse",!1);if(s=e[0],"[object Array]"===Object.prototype.toString.call(s))if(o)for(u=(h=e.length)-1;u>=0;u--)r=t(e[u],i,n);else for(var u=0,h=e.length;u<h;u++)r=t(e[u],i,n);else r=d(e,i,n);return r},d=function(t,e,i){var n,r=a(i,"argsConvert",void 0),s=a(i,"argsConvertScope",void 0),o=t[0];if(m=f(m,t,1),r){!0===r&&(r=l,s=void 0);for(var u=0,h=m.length;u<h;u++)m[u]=s?r.call(s,m[u],t):r(m[u],t);}return "string"==typeof o?null==(n=e[o])&&(n=a(e,o,null)):n=o,n.apply(e,m)},m=[],y=function(){function t(e){n(this,t),this.setEventEmitter(a(e,"eventEmitter",void 0)),this.commands=[],this.scope=void 0,this.config=void 0,this.index=0,this.indexStep=1,this.setYoyo(a(e,"yoyo",!1)),this.setRepeat(a(e,"repeat",0)),this.setLoop(a(e,"loop",!1)),this.state=0,this.task=void 0;}return s(t,[{key:"shutdown",value:function(){this.stop(),this.destroyEventEmitter(),this.commands.length=0,this.scope=void 0,this.config=void 0;}},{key:"destroy",value:function(){this.shutdown();}},{key:"load",value:function(t,e,i){return this.stop(),this.setYoyo(a(i,"yoyo",this.yoyo)),this.setRepeat(a(i,"repeat",this.repeat)),this.setLoop(a(i,"loop",this.loop)),this.commands=f(this.commands,t),this.scope=e,this.config=i,this}},{key:"start",value:function(){return this.stop(),this.resetRepeatCount(),this.index=0,this.indexStep=1,this.state=1,this.commands.length>0?this.runNextCommands():this.complete(),this}},{key:"stop",value:function(){return this.task&&(this.task.off("complete",this.runNextCommands,this),this.task=void 0),this.state=0,this}},{key:"setYoyo",value:function(t){return void 0===t&&(t=!0),this.yoyo=t,this}},{key:"setRepeat",value:function(t){return this.repeat=t,this.resetRepeatCount(),this}},{key:"setLoop",value:function(t){return void 0===t&&(t=!0),this.loop=t,this.resetRepeatCount(),this}},{key:"resetRepeatCount",value:function(){return this.repeatCount=-1===this.repeat||this.loop?999999999999:this.repeat,this}},{key:"completed",get:function(){return 3===this.state}},{key:"currentCommandIndex",get:function(){return this.index-1}},{key:"runNextCommands",value:function(){for(var t,e,i;;){if(2===this.state)return void this.complete();if((t=v(this.commands[this.index],this.scope))&&"function"==typeof t.once?(t.once("complete",this.runNextCommands,this),this.task=t):this.task=void 0,e=0===this.index,i=this.index===this.commands.length-1,this.yoyo?this.indexStep>0&&i||this.indexStep<0&&e?(this.indexStep=-this.indexStep,this.index+=this.indexStep,this.repeatCount>0?this.repeatCount--:this.state=2):this.index+=this.indexStep:i?(this.index=0,this.repeatCount>0?this.repeatCount--:this.state=2):this.index+=this.indexStep,this.task)return this}}},{key:"complete",value:function(){this.state=3,this.emit("complete",this.scope,this);}}]),t}();return Object.assign(y.prototype,h),function(e){function i(e){return n(this,i),t(this,i,[e])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);}(i,Phaser.Plugins.BasePlugin),s(i,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this);}},{key:"add",value:function(t){return new y(t)}}]),i}()}));
